<ng-container *ngIf="fetchSummary;else elseback">
  <form [formGroup]="searchSummaryForm" class="flex align-items-center flex-wrap">

    <div class="col-4">
      <app-custom-input-text
        formControlName="code"
        label="کد"
      ></app-custom-input-text>
    </div>

    <div class="col-4">
      <app-custom-input-text
        formControlName="title"
        label="عنوان"
      ></app-custom-input-text>

    </div>

    <app-custom-button
      type="button"
      (onClick)="handleSummarySearch()"
      label="جستجو"
      icon="pi pi-search"
      class="mb-2"
    ></app-custom-button>

  </form>
  <ng-container *ngTemplateOutlet="gridForm"></ng-container>
</ng-container>

<ng-template #elseback>
  <app-custom-card>
    <ng-container *ngTemplateOutlet="gridForm"></ng-container>
  </app-custom-card>
</ng-template>

<ng-template #gridForm>
  <div [class]="class">

    <div class="flex align-items-center justify-content-between">
      <div class="flex-grow-1" *ngIf="!fetchSummary">
        <app-criteria-builder
          #criteriaBuilder
          [form]="form"
          [colDefs]="columnDefs"
          [resetForm]="false"
          [icon]="'pi pi-search'"
          (onAddCriteria)="handleAddCriteria($event)"
        ></app-criteria-builder>
      </div>
      <app-grid-actions
        #gridActions
        [gridHistory]="gridHistory"
        [accessFormActions]="accessFormActions"
        [selectedRow]="selectedRow"
        [hasCriteria]="!!criteria"
        (clickHistory)="handleClickHistory($event)"
        (onAction)="handleOnAction($event)"
      ></app-grid-actions>
    </div>

    <ag-grid-angular
      #grid
      class="ag-theme-alpine"
      [columnDefs]="columnDefs"
      [gridOptions]="gridOptions"
      (rowDoubleClicked)="handleRowDbClicked($event)"
      (rowClicked)="handleRowClicked($event)"
      (sortChanged)="handleSortChange($event)"
    ></ag-grid-angular>

  </div>
</ng-template>
